(function(){"use strict";var e={8770:function(e,t,a){var n=a(3751),o=a(641);const r={class:"app-container"},s={id:"div1"},l={id:"div2"},i={id:"div3"},c={id:"div4"};function d(e,t,a,n,d,h){const u=(0,o.g2)("MapComponent"),p=(0,o.g2)("ControlComponent"),m=(0,o.g2)("ChartComponent"),g=(0,o.g2)("LegendComponent");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",s,[(0,o.bF)(u,{scope:d.selectedScope,year:d.selectedYear,week:d.selectedWeek},null,8,["scope","year","week"]),(0,o.Lk)("div",l,[(0,o.bF)(p,{onUpdateScope:h.handleScopeUpdate,onUpdateData:h.handleDataUpdate,onUpdateColor:h.handleColorUptade},null,8,["onUpdateScope","onUpdateData","onUpdateColor"])])]),(0,o.Lk)("div",i,[(0,o.bF)(m)]),(0,o.Lk)("div",c,[(0,o.bF)(g)])])}const h={class:"control-component"},u=(0,o.Lk)("br",null,null,-1);function p(e,t,a,n,r,s){const l=(0,o.g2)("ScopeComponent"),i=(0,o.g2)("ButtonComponent"),c=(0,o.g2)("SliderComponent");return(0,o.uX)(),(0,o.CE)("div",h,[(0,o.bF)(l,{onScopeChanged:s.handleScopeChange},null,8,["onScopeChanged"]),(0,o.bF)(i,{onButtonClick:s.handleButtonClick},null,8,["onButtonClick"]),u,(0,o.bF)(c,{onSliderChange:s.handleSliderChange},null,8,["onSliderChange"])])}var m=a(33);const g=e=>((0,o.Qi)("data-v-784d8b8d"),e=e(),(0,o.jt)(),e),f={class:"col"},v=g((()=>(0,o.Lk)("div",{class:"row"},[(0,o.Lk)("label",{for:"",class:"text-start"},"Year:")],-1))),y={class:"col"},C=["onClick"];function k(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",f,[v,(0,o.Lk)("div",y,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.buttons,(e=>((0,o.uX)(),(0,o.CE)("button",{id:"button-range",key:e.label,onClick:t=>s.emitValue(e.value),type:"button",class:"btn btn-outline-info btn-sm me-1 custom-spacing"},(0,m.v_)(e.label),9,C)))),128))])])}a(4114);var b={name:"ButtonComponent",data(){return{buttons:this.construct_buttons()}},methods:{emitValue(e){this.$emit("button-click",e)},construct_buttons(){let e=[];for(let t=2018;t<2023;t++)e.push({label:t,value:t});return e}}},w=a(6262);const D=(0,w.A)(b,[["render",k],["__scopeId","data-v-784d8b8d"]]);var S=D;const A=(0,o.Lk)("div",{class:"row"},[(0,o.Lk)("label",{for:"",class:"text-start"},"Weeks:")],-1);function L(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",null,[A,(0,o.Lk)("input",{id:"small-range",type:"range",min:"1",max:"52",value:"1",onInput:t[0]||(t[0]=(...e)=>s.handleInputChange&&s.handleInputChange(...e)),class:"form-range custom-spacing"},null,32)])}var E={name:"SliderComponent",data(){return{currentValue:1}},methods:{handleInputChange(e){this.currentValue=e.target.value,this.$emit("slider-change",this.currentValue)}}};const _=(0,w.A)(E,[["render",L]]);var j=_;const x=e=>((0,o.Qi)("data-v-28f40a62"),e=e(),(0,o.jt)(),e),O={class:"d-flex"},F={class:"form-check custom-spacing"},W=x((()=>(0,o.Lk)("label",{class:"form-check-label",for:"national"}," National ",-1))),U={class:"form-check"},X=x((()=>(0,o.Lk)("label",{class:"form-check-label",for:"regional"}," Regional ",-1)));function Y(e,t,a,r,s,l){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",O,[(0,o.Lk)("div",F,[(0,o.bo)((0,o.Lk)("input",{class:"form-check-input",type:"radio",id:"national",value:"national","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedScope=e),onChange:t[1]||(t[1]=(...e)=>l.emitScope&&l.emitScope(...e))},null,544),[[n.XL,s.selectedScope]]),W]),(0,o.Lk)("div",U,[(0,o.bo)((0,o.Lk)("input",{class:"form-check-input",type:"radio",id:"regional",value:"regional","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedScope=e),onChange:t[3]||(t[3]=(...e)=>l.emitScope&&l.emitScope(...e))},null,544),[[n.XL,s.selectedScope]]),X])])])}var M={name:"ScopeComponent",data(){return{selectedScope:"national"}},methods:{emitScope(){this.$emit("scope-changed",this.selectedScope)}}};const $=(0,w.A)(M,[["render",Y],["__scopeId","data-v-28f40a62"]]);var I=$,P={name:"ControlComponent",components:{ButtonComponent:S,SliderComponent:j,ScopeComponent:I},methods:{handleButtonClick(e){this.$emit("update-data",e)},handleSliderChange(e){this.$emit("update-color",e)},handleScopeChange(e){this.$emit("update-scope",e)}}};const R=(0,w.A)(P,[["render",p]]);var N=R;const B={id:"mapContainer",ref:"mapContainer",class:"map-container"};function G(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",B,null,512)}var Q=a(8261),V=a(8694),T=a(1067),q=a(9623),K=a(6800),H=a(3707),z=a(592),J=a(1240),Z=a(6717),ee=a(4294),te=a(9700),ae=a(9276),ne=a(3628),oe=a(3334),re=a(2768),se=a.n(re),le=(a(2488),{name:"MapComponent",props:{year:Number,week:String,scope:String},mounted(){this.initMap("national"),this.constructData("national"),this.constructData("regional")},data(){return{color_scale:se().scale("YlOrRd").colors(7),vectors:{national:this.vectorGenerator("national"),regional:this.vectorGenerator("regional")},allData:{week:1,selectedYear:2018,selectedWeek:"w_01",selectedScope:"national",scope:{national:{},regional:{}}}}},methods:{initMap(e){this.map=new Q.A({target:this.$refs.mapContainer,projection:"EPSG:4326",layers:[new T.A({source:new q.A}),this.vectorGenerator(e)],view:new V.Ay({center:(0,K.Rb)([12,42]),zoom:6})}),this.map.on("singleclick",this.handleMapClick)},_deleteFirstKey(e){return Object.values(e).slice(1,53)},_keyFinder(e,t,a){return e.find((e=>e[t]==a))},vectorGenerator(e){return new H.A({source:new z.A({url:"./assets/"+e+"/geometry.geojson",format:new J.A}),style:new ae.Ay({fill:new ne.A({color:"rgba(255, 255, 204, 0.7)"}),stroke:new oe.A({color:"#000000",width:.5})})})},iconEmplacement(e){let t=this.map.getLayers().getArray();if(t.length>2){let e=t[t.length-1];this.map.removeLayer(e),this.map.getLayers().getArray()[t.length-1].getSource().changed()}let a=new Z.A({geometry:new ee.A((0,K.Rb)(e))});a.setStyle(new ae.Ay({image:new te.A({color:"#000000",crossOrigin:"",src:"assets/icon.svg",scale:1})}));const n=new H.A({source:new z.A({features:[a]})});this.map.addLayer(n)},handleMapClick(e){const t=this.map.getEventPixel(e.originalEvent);let a=(0,K.WP)(e.coordinate);this.iconEmplacement(a),this.map.forEachFeatureAtPixel(t,(e=>{const t=e.get("NAME_1");this.allData.selectedRegion=t,this.updateData(this.allData)}))},reStyleFeatures(e,t){let a=e=>{let a=this.map.getLayers().getArray()[1];a.setStyle((a=>{let n=this.allData["scope"][this.allData.selectedScope][t].find((e=>e["NAME_1"]===a.get("NAME_1")))[e];return new ae.Ay({fill:new ne.A({color:this.colorGenerator(n)}),stroke:new oe.A({color:"#000000",width:.5})})}))};try{a(e)}catch(n){a(e)}},colorGenerator(e){const t=[10,25,50,100,200,400];for(let a=0;t.length;a++)if(e<=t[a])return se()(this.color_scale[a]).alpha(.7)},async constructData(e){await this.fetchData("./assets/"+e+"/firstQ.json","firstQ",e),await this.fetchData("./assets/"+e+"/thirdQ.json","thirdQ",e),await this.fetchData("./assets/"+e+"/median.json","median",e),await this.fetchData("./assets/"+e+"/2018.json","2018",e),await this.fetchData("./assets/"+e+"/2019.json","2019",e),await this.fetchData("./assets/"+e+"/2020.json","2020",e),await this.fetchData("./assets/"+e+"/2021.json","2021",e),await this.fetchData("./assets/"+e+"/2022.json","2022",e),this.updateData(this.allData)},async fetchData(e,t,a){try{const n=await fetch(e);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);const o=await n.json();this.allData["scope"][a][t]=o}catch(n){console.error("Failed to fetch or parse data:",n.message)}},replaceLayer(e){let t=this.map.getLayers().getArray();3==t.length&&(this.map.removeLayer(t[2]),this.map.removeLayer(t[1])),2==t.length&&this.map.removeLayer(t[1]);let a=this.vectors[e];this.map.addLayer(a),this.map.getLayers().getArray()[1].getSource().changed()},updateData(e){this.$store.dispatch("updateData",e)}},watch:{year(e){this.reStyleFeatures(this.allData.selectedWeek,this.allData.selectedYear),this.allData.selectedYear=e,this.updateData(this.allData)},week(e){Number(e)<10?this.allData.selectedWeek="w_0"+e:this.allData.selectedWeek="w_"+e,this.allData.week=e,this.reStyleFeatures(this.allData.selectedWeek,this.allData.selectedYear),this.updateData(this.allData)},scope(e){this.replaceLayer(e),this.allData.selectedScope=e,this.allData.selectedRegion=null,this.updateData(this.allData),this.reStyleFeatures(this.allData.selectedWeek,this.allData.selectedYear)}}});const ie=(0,w.A)(le,[["render",G],["__scopeId","data-v-f4b858fa"]]);var ce=ie;const de={ref:"plotContainer",style:{width:"100%",height:"100%"}};function he(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",de,null,512)}var ue=a(4708),pe=a.n(ue),me=a(6278),ge={data(){return{weeks:Array.from({length:52},((e,t)=>t+1))}},computed:{...(0,me.aH)({plotData:e=>e.sharedData})},mounted(){this.renderEmpty()},watch:{plotData:{handler(e){this.generateChart(e)},immediate:!0,deep:!0}},methods:{renderEmpty(){pe().newPlot(this.$refs.plotContainer,[{x:[],y:[]}],{})},parseObject(e,t){let a=e["scope"][e.selectedScope][t].find((t=>t["NAME_1"]==e.selectedRegion));return Object.values(a).slice(1,53)},generateChart(e){let t="";if("regional"===e.selectedScope&&(t="Province of "),void 0!==e.selectedRegion)try{let a=e.selectedYear,n=t+e.selectedRegion,o={title:n+" in "+String(a),xaxis:{title:"Week",range:[1,52]},yaxis:{title:"Number of eggs",range:[0,400]},showlegend:!0},r=[{x:this.weeks,y:this.parseObject(e,e.selectedYear),type:"scatter",name:e.selectedYear,hoverinfo:"y",line:{color:"gray"}},{x:this.weeks,y:this.parseObject(e,"median"),type:"scatter",name:e.selectedScope+"<br>median",hoverinfo:"y",line:{color:"blue",dash:"dash"}},{x:[e.week,e.week],y:[0,400],type:"scatter",name:"week",hoverinfo:"x",line:{color:"red"}}];pe().newPlot(this.$refs.plotContainer,r,o)}catch(a){this.renderEmpty()}}}};const fe=(0,w.A)(ge,[["render",he]]);var ve=fe;const ye=e=>((0,o.Qi)("data-v-c1168456"),e=e(),(0,o.jt)(),e),Ce={class:"container"},ke=ye((()=>(0,o.Lk)("p",{class:"legendtitle"},[(0,o.eW)("Number of"),(0,o.Lk)("br"),(0,o.eW)("Mosquito"),(0,o.Lk)("br"),(0,o.eW)("Eggs")],-1)));function be(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",Ce,[ke,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.values,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,style:(0,m.Tr)({backgroundColor:s.colorgenerator(e)}),class:"color-box"},(0,m.v_)(this.labels[t]),5)))),128))])}var we={name:"LegendComponent",data(){return{values:[10,25,50,100,200,400],labels:["0 - 10","10 - 25","25 - 50","50 - 100","100 - 200","200 - 400","400 > "],colorscale:se().scale("YlOrRd").colors(7)}},methods:{colorgenerator(e){const t=[10,25,50,100,200,400];for(let a=0;a<t.length;a++)if(e<=t[a])return se()(this.colorscale[a]).alpha(.7).css()}}};const De=(0,w.A)(we,[["render",be],["__scopeId","data-v-c1168456"]]);var Se=De,Ae={name:"App",components:{LegendComponent:Se,ControlComponent:N,MapComponent:ce,ChartComponent:ve},data(){return{selectedYear:2018,selectedWeek:"1",selectedScope:"national"}},methods:{handleDataUpdate(e){this.selectedYear=e},handleColorUptade(e){this.selectedWeek=e},handleScopeUpdate(e){this.selectedScope=e}}};const Le=(0,w.A)(Ae,[["render",d]]);var Ee=Le,_e=(0,me.y$)({state:{sharedData:{}},mutations:{updateData(e,t){e.sharedData=t}},actions:{updateData({commit:e},t){e("updateData",t)}}});const je=(0,n.Ef)(Ee);je.use(_e),je.mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,r){if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],r=e[d][2];for(var l=!0,i=0;i<n.length;i++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[i])}))?n.splice(i--,1):(l=!1,r<s&&(s=r));if(l){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,s=n[0],l=n[1],i=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(i)var d=i(a)}for(t&&t(n);c<s.length;c++)r=s[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=self["webpackChunkmosquito_alert_system"]=self["webpackChunkmosquito_alert_system"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(8770)}));n=a.O(n)})();
//# sourceMappingURL=app.5a9bbd49.js.map