(function(){"use strict";var e={1002:function(e,t,a){var n=a(3751),o=a(641);const r={class:"app-container"},s={id:"div1"},l={id:"div2"},i={id:"div3"};function c(e,t,a,n,c,d){const u=(0,o.g2)("MapComponent"),h=(0,o.g2)("ControlComponent"),p=(0,o.g2)("ChartComponent");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",s,[(0,o.bF)(u,{scope:c.selectedScope,year:c.selectedYear,week:c.selectedWeek},null,8,["scope","year","week"]),(0,o.Lk)("div",l,[(0,o.bF)(h,{onUpdateScope:d.handleScopeUpdate,onUpdateData:d.handleDataUpdate,onUpdateColor:d.handleColorUptade},null,8,["onUpdateScope","onUpdateData","onUpdateColor"])])]),(0,o.Lk)("div",i,[(0,o.bF)(p)])])}const d={class:"control-component"},u=(0,o.Lk)("br",null,null,-1);function h(e,t,a,n,r,s){const l=(0,o.g2)("ScopeComponent"),i=(0,o.g2)("ButtonComponent"),c=(0,o.g2)("SliderComponent");return(0,o.uX)(),(0,o.CE)("div",d,[(0,o.bF)(l,{onScopeChanged:s.handleScopeChange},null,8,["onScopeChanged"]),(0,o.bF)(i,{onButtonClick:s.handleButtonClick},null,8,["onButtonClick"]),u,(0,o.bF)(c,{onSliderChange:s.handleSliderChange},null,8,["onSliderChange"])])}var p=a(33);const m=e=>((0,o.Qi)("data-v-784d8b8d"),e=e(),(0,o.jt)(),e),f={class:"col"},g=m((()=>(0,o.Lk)("div",{class:"row"},[(0,o.Lk)("label",{for:"",class:"text-start"},"Year:")],-1))),v={class:"col"},C=["onClick"];function y(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",f,[g,(0,o.Lk)("div",v,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.buttons,(e=>((0,o.uX)(),(0,o.CE)("button",{id:"button-range",key:e.label,onClick:t=>s.emitValue(e.value),type:"button",class:"btn btn-outline-info btn-sm me-1 custom-spacing"},(0,p.v_)(e.label),9,C)))),128))])])}a(4114);var k={name:"ButtonComponent",data(){return{buttons:this.construct_buttons()}},methods:{emitValue(e){this.$emit("button-click",e)},construct_buttons(){let e=[];for(let t=2018;t<2023;t++)e.push({label:t,value:t});return e}}},b=a(6262);const w=(0,b.A)(k,[["render",y],["__scopeId","data-v-784d8b8d"]]);var D=w;const S=(0,o.Lk)("div",{class:"row"},[(0,o.Lk)("label",{for:"",class:"text-start"},"Weeks:")],-1);function A(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",null,[S,(0,o.Lk)("input",{id:"small-range",type:"range",min:"1",max:"52",value:"1",onInput:t[0]||(t[0]=(...e)=>s.handleInputChange&&s.handleInputChange(...e)),class:"form-range custom-spacing"},null,32)])}var L={name:"SliderComponent",data(){return{currentValue:1}},methods:{handleInputChange(e){this.currentValue=e.target.value,this.$emit("slider-change",this.currentValue)}}};const _=(0,b.A)(L,[["render",A]]);var j=_;const E=e=>((0,o.Qi)("data-v-28f40a62"),e=e(),(0,o.jt)(),e),x={class:"d-flex"},O={class:"form-check custom-spacing"},F=E((()=>(0,o.Lk)("label",{class:"form-check-label",for:"national"}," National ",-1))),U={class:"form-check"},Y=E((()=>(0,o.Lk)("label",{class:"form-check-label",for:"regional"}," Regional ",-1)));function M(e,t,a,r,s,l){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",x,[(0,o.Lk)("div",O,[(0,o.bo)((0,o.Lk)("input",{class:"form-check-input",type:"radio",id:"national",value:"national","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedScope=e),onChange:t[1]||(t[1]=(...e)=>l.emitScope&&l.emitScope(...e))},null,544),[[n.XL,s.selectedScope]]),F]),(0,o.Lk)("div",U,[(0,o.bo)((0,o.Lk)("input",{class:"form-check-input",type:"radio",id:"regional",value:"regional","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedScope=e),onChange:t[3]||(t[3]=(...e)=>l.emitScope&&l.emitScope(...e))},null,544),[[n.XL,s.selectedScope]]),Y])])])}var $={name:"ScopeComponent",data(){return{selectedScope:"national"}},methods:{emitScope(){this.$emit("scope-changed",this.selectedScope)}}};const W=(0,b.A)($,[["render",M],["__scopeId","data-v-28f40a62"]]);var X=W,I={name:"ControlComponent",components:{ButtonComponent:D,SliderComponent:j,ScopeComponent:X},methods:{handleButtonClick(e){this.$emit("update-data",e)},handleSliderChange(e){this.$emit("update-color",e)},handleScopeChange(e){this.$emit("update-scope",e)}}};const N=(0,b.A)(I,[["render",h]]);var P=N;const B={id:"mapContainer",ref:"mapContainer",class:"map-container"};function G(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",B,null,512)}var R=a(8261),V=a(8694),Q=a(1067),T=a(9623),q=a(6800),H=a(3707),K=a(592),z=a(5214),J=a(9276),Z=a(3628),ee=a(3334),te=a(2768),ae=a.n(te),ne=(a(2488),{name:"MapComponent",props:{year:Number,week:String,scope:String},mounted(){this.initMap("national"),this.constructData("national"),this.constructData("regional")},data(){return{color_scale:ae().scale("YlOrRd").colors(7),vectors:{national:this.vectorGenerator("national"),regional:this.vectorGenerator("regional")},allData:{selectedYear:2018,selectedWeek:"w_01",selectedScope:"national",scope:{national:{},regional:{}}}}},methods:{initMap(e){this.map=new R.A({target:this.$refs.mapContainer,projection:"EPSG:4326",layers:[new Q.A({source:new T.A}),this.vectorGenerator(e)],view:new V.Ay({center:(0,q.Rb)([12,42]),zoom:6})}),this.map.on("singleclick",this.handleMapClick)},_deleteFirstKey(e){return Object.values(e).slice(1,53)},_keyFinder(e,t,a){return e.find((e=>e[t]==a))},vectorGenerator(e){return new H.A({source:new K.A({url:"./assets/"+e+"/geometry.geojson",format:new z.A}),style:new J.Ay({fill:new Z.A({color:"rgba(255, 255, 204, 0.7)"}),stroke:new ee.A({color:"#000000",width:.5})})})},handleMapClick(e){const t=this.map.getEventPixel(e.originalEvent);this.map.forEachFeatureAtPixel(t,(e=>{const t=e.get("NAME_1");this.allData.selectedRegion=t,this.updateData(this.allData)}))},reStyleFeatures(e,t){let a=e=>{let a=this.map.getLayers().getArray()[1];a.setStyle((a=>{let n=this.allData["scope"][this.allData.selectedScope][t].find((e=>e["NAME_1"]===a.get("NAME_1")))[e];return new J.Ay({fill:new Z.A({color:this.colorGenerator(n)}),stroke:new ee.A({color:"#000000",width:.5})})}))};try{a(e)}catch(n){a(e)}},colorGenerator(e){const t=[10,25,50,100,200,400];for(let a=0;t.length;a++)if(e<=t[a])return ae()(this.color_scale[a]).alpha(.7)},async constructData(e){await this.fetchData("./assets/"+e+"/firstQ.json","firstQ",e),await this.fetchData("./assets/"+e+"/thirdQ.json","thirdQ",e),await this.fetchData("./assets/"+e+"/median.json","median",e),await this.fetchData("./assets/"+e+"/2018.json","2018",e),await this.fetchData("./assets/"+e+"/2019.json","2019",e),await this.fetchData("./assets/"+e+"/2020.json","2020",e),await this.fetchData("./assets/"+e+"/2021.json","2021",e),await this.fetchData("./assets/"+e+"/2022.json","2022",e),this.updateData(this.allData)},async fetchData(e,t,a){try{const n=await fetch(e);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);const o=await n.json();this.allData["scope"][a][t]=o}catch(n){console.error("Failed to fetch or parse data:",n.message)}},replaceLayer(e){let t=this.vectors[e],a=this.map.getLayers().getArray()[1];this.map.removeLayer(a),this.map.addLayer(t),this.map.getLayers().getArray()[1].getSource().changed()},updateData(e){this.$store.dispatch("updateData",e)}},watch:{year(e){this.reStyleFeatures(this.allData.selectedWeek,this.allData.selectedYear),this.allData.selectedYear=e,this.updateData(this.allData)},week(e){Number(e)<10?this.allData.selectedWeek="w_0"+e:this.allData.selectedWeek="w_"+e,this.reStyleFeatures(this.allData.selectedWeek,this.allData.selectedYear),this.updateData(this.allData)},scope(e){this.replaceLayer(e),this.allData.selectedScope=e,this.updateData(this.allData),this.reStyleFeatures(this.allData.selectedWeek,this.allData.selectedYear)}}});const oe=(0,b.A)(ne,[["render",G],["__scopeId","data-v-7114c614"]]);var re=oe;const se={ref:"plotContainer",style:{width:"100%",height:"100%"}};function le(e,t,a,n,r,s){return(0,o.uX)(),(0,o.CE)("div",se,null,512)}var ie=a(4708),ce=a.n(ie),de=a(6278),ue={data(){return{weeks:Array.from({length:52},((e,t)=>t+1))}},computed:{...(0,de.aH)({plotData:e=>e.sharedData})},mounted(){this.renderEmpty()},watch:{plotData:{handler(e){this.generateChart(e)},immediate:!0,deep:!0}},methods:{renderEmpty(){ce().newPlot(this.$refs.plotContainer,[{x:[],y:[]}],{})},parseObject(e,t){let a=e["scope"][e.selectedScope][t].find((t=>t["NAME_1"]==e.selectedRegion));return Object.values(a).slice(1,53)},generateChart(e){if(void 0!==e.selectedRegion)try{let t=e.selectedYear,a=e.selectedRegion,n={title:a+" in "+String(t),xaxis:{title:"Week"},yaxis:{title:"Number of eggs"},showlegend:!0},o=[{x:this.weeks,y:this.parseObject(e,e.selectedYear),type:"scatter",name:e.selectedYear,hoverinfo:"y",line:{color:"gray"}},{x:this.weeks,y:this.parseObject(e,"median"),type:"scatter",name:"median",hoverinfo:"y",line:{color:"blue",dash:"dash"}}];ce().newPlot(this.$refs.plotContainer,o,n)}catch(t){this.renderEmpty()}}}};const he=(0,b.A)(ue,[["render",le]]);var pe=he,me={name:"App",components:{ControlComponent:P,MapComponent:re,ChartComponent:pe},data(){return{selectedYear:2018,selectedWeek:"1",selectedScope:"national"}},methods:{handleDataUpdate(e){this.selectedYear=e},handleColorUptade(e){this.selectedWeek=e},handleScopeUpdate(e){this.selectedScope=e}}};const fe=(0,b.A)(me,[["render",c]]);var ge=fe,ve=(0,de.y$)({state:{sharedData:{}},mutations:{updateData(e,t){e.sharedData=t}},actions:{updateData({commit:e},t){e("updateData",t)}}});const Ce=(0,n.Ef)(ge);Ce.use(ve),Ce.mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,r){if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],r=e[d][2];for(var l=!0,i=0;i<n.length;i++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[i])}))?n.splice(i--,1):(l=!1,r<s&&(s=r));if(l){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,s=n[0],l=n[1],i=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(i)var d=i(a)}for(t&&t(n);c<s.length;c++)r=s[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=self["webpackChunkmosquito_alert_system"]=self["webpackChunkmosquito_alert_system"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(1002)}));n=a.O(n)})();
//# sourceMappingURL=app.4c4a17ef.js.map